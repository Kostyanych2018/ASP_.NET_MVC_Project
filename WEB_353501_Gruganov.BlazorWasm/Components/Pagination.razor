@* @implements IDisposable *@
@inject IDataService DataService

@if (DataService.TotalPages > 1) {
    <nav aria-label="Навигация по страницам">
        <ul class="pagination">
            @if (DataService.CurrentPage > 1) {
                <li class="page-item">
                    <button class="page-link" @onclick="() => GoToPage(DataService.CurrentPage - 1)" type="button">
                        Предыдущая
                    </button>
                </li>
            }
            else {
                <li class="page-item disabled">
                    <button class="page-link" type="button" disabled>Предыдущая</button>
                </li>
            }

            @for (int i = 1; i <= DataService.TotalPages; i++) {
                var pageNumber = i;
                <li class="page-item @(DataService.CurrentPage == pageNumber ? "active" : "")">
                    <button class="page-link" @onclick="() => GoToPage(pageNumber)" type="button">
                        @pageNumber
                    </button>
                </li>
            }

            @if (DataService.CurrentPage < DataService.TotalPages) {
                <li class="page-item">
                    <button class="page-link" @onclick="() => GoToPage(DataService.CurrentPage + 1)" type="button">
                        Следующая
                    </button>
                </li>
            }
            else {
                <li class="page-item disabled">
                    <button class="page-link" type="button" disabled>Следующая</button>
                </li>
            }
        </ul>
    </nav>
}

@code {
    [Parameter] public string? CategoryName { get; set; }

    protected override void OnInitialized()
    {
        DataService.DataLoaded += StateHasChanged;
    }

    private async Task GoToPage(int pageNo)
    {
        await DataService.GetGamesListAsync(pageNo);
        StateHasChanged();
    }

    public void Dispose()
    {
        DataService.DataLoaded -= StateHasChanged;
    }

}

